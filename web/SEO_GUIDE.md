# SEO Implementation Guide

This guide shows how to use the SEO utilities to optimize your pages for search engines and social media.

---

## Overview

The SEO system provides:
- **Dynamic meta tags** for all pages
- **Open Graph** tags for social media
- **Twitter Cards** for Twitter sharing
- **JSON-LD structured data** for rich snippets
- **Sitemap** generation
- **robots.txt** configuration

---

## Basic Usage

### 1. Page Metadata

For any page, use `generateMetadata`:

```typescript
// app/about/page.tsx
import { generateMetadata as createMetadata } from '@/lib/seo';

export const metadata = createMetadata({
    title: 'Hakkımızda',
    description: 'İkinci Ses hakkında bilgi edinin',
    url: '/about',
});

export default function AboutPage() {
    return <div>...</div>;
}
```

---

## Listing Detail Page

### Complete Implementation

```typescript
// app/listings/[id]/page.tsx
import { notFound } from 'next/navigation';
import { prisma } from '@/lib/prisma';
import { generateListingMetadata, generateListingJsonLd, JsonLd } from '@/lib/seo';

export async function generateMetadata({ params }: { params: { id: string } }) {
    const listing = await prisma.listing.findUnique({
        where: { id: params.id },
        include: {
            category: true,
            brand: true,
            user: true,
        },
    });

    if (!listing) return {};

    return generateListingMetadata(listing);
}

export default async function ListingPage({ params }: { params: { id: string } }) {
    const listing = await prisma.listing.findUnique({
        where: { id: params.id },
        include: {
            category: true,
            brand: true,
            user: true,
        },
    });

    if (!listing) notFound();

    // Generate JSON-LD structured data
    const jsonLd = generateListingJsonLd(listing);

    return (
        <>
            <JsonLd data={jsonLd} />
            <div>
                {/* Your listing content */}
            </div>
        </>
    );
}
```

---

## User Profile Page

```typescript
// app/profile/[id]/page.tsx
import { generateUserMetadata } from '@/lib/seo';

export async function generateMetadata({ params }: { params: { id: string } }) {
    const user = await prisma.user.findUnique({
        where: { id: params.id },
        select: {
            id: true,
            name: true,
            avatar: true,
            totalReviews: true,
            averageRating: true,
        },
    });

    if (!user) return {};

    return generateUserMetadata(user);
}
```

---

## Custom Metadata

For pages with custom requirements:

```typescript
import { generateMetadata } from '@/lib/seo';

export const metadata = generateMetadata({
    title: 'Sıkça Sorulan Sorular',
    description: 'İkinci el müzik aleti alım-satımı hakkında sıkça sorulan sorular',
    url: '/faq',
    type: 'article',
    keywords: ['sss', 'yardım', 'destek'],
});
```

---

## JSON-LD Structured Data

### Product Schema (Listings)

Automatically generated by `generateListingJsonLd()`. Example output:

```json
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "Fender Stratocaster",
  "description": "Mükemmel durumda elektro gitar",
  "image": ["https://..."],
  "offers": {
    "@type": "Offer",
    "price": 15000,
    "priceCurrency": "TRY",
    "availability": "https://schema.org/InStock",
    "itemCondition": "https://schema.org/UsedCondition"
  }
}
```

### Organization Schema

Add to your homepage:

```typescript
// app/page.tsx
import { generateOrganizationJsonLd, JsonLd } from '@/lib/seo';

export default function HomePage() {
    const orgJsonLd = generateOrganizationJsonLd();

    return (
        <>
            <JsonLd data={orgJsonLd} />
            {/* Your homepage content */}
        </>
    );
}
```

---

## Sitemap

The sitemap is automatically generated at `/api/sitemap`.

### Features:
- **Static pages** (homepage, listings, questions, etc.)
- **Category pages**
- **All active listings**
- **Automatic updates** (1-hour cache)

### Usage in robots.txt:

Already configured in [public/robots.txt](file:///Users/emirarslan/Desktop/ikinci_el_muzik/web/public/robots.txt):

```txt
Sitemap: https://ikincises.com/sitemap.xml
```

### Submit to Search Engines:

1. **Google Search Console**: Submit `https://ikincises.com/api/sitemap`
2. **Bing Webmaster Tools**: Submit the same URL

---

## robots.txt

Already created at [public/robots.txt](file:///Users/emirarslan/Desktop/ikinci_el_muzik/web/public/robots.txt).

### Configuration:

```txt
User-agent: *
Allow: /

# Disallow admin and private routes
Disallow: /admin
Disallow: /api/
Disallow: /auth/

# Sitemap location
Sitemap: https://ikincises.com/sitemap.xml
```

---

## Open Graph Tags

Automatically included in all metadata. Example:

```html
<meta property="og:type" content="product" />
<meta property="og:title" content="Fender Stratocaster | İkinci Ses" />
<meta property="og:description" content="..." />
<meta property="og:image" content="https://..." />
<meta property="og:url" content="https://ikincises.com/listings/123" />
```

### Test Your Open Graph Tags:

- [Facebook Debugger](https://developers.facebook.com/tools/debug/)
- [LinkedIn Post Inspector](https://www.linkedin.com/post-inspector/)

---

## Twitter Cards

Automatically included for Twitter sharing:

```html
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="..." />
<meta name="twitter:description" content="..." />
<meta name="twitter:image" content="..." />
```

### Test Your Twitter Cards:

- [Twitter Card Validator](https://cards-dev.twitter.com/validator)

---

## Best Practices

### 1. Title Optimization

```typescript
// ✅ Good: Descriptive, includes keywords
title: 'Fender Stratocaster - İkinci El Elektro Gitar'

// ❌ Bad: Too short, no keywords
title: 'Gitar'
```

### 2. Description Optimization

```typescript
// ✅ Good: 120-155 characters, describes content
description: 'Mükemmel durumda 2018 model Fender Stratocaster elektro gitar. Hardcase ile birlikte. Ankara\'da elden teslim.'

// ❌ Bad: Too short or too long
description: 'Gitar satılık'
```

### 3. Image Optimization

- Use high-quality images (min 1200x630 for OG images)
- Use descriptive alt text
- Optimize file size for faster loading

### 4. URL Structure

```typescript
// ✅ Good: Clean, descriptive URLs
/listings/fender-stratocaster-elektro-gitar

// ❌ Avoid: Generic IDs only
/listings/abc123
```

---

## SEO Checklist

### Per Page:
- [ ] Unique, descriptive title (50-60 chars)
- [ ] Meta description (120-155 chars)
- [ ] Open Graph tags
- [ ] Twitter Card tags
- [ ] Canonical URL
- [ ] Structured data (if applicable)

### Site-wide:
- [ ] robots.txt configured
- [ ] Sitemap submitted to search engines
- [ ] SSL certificate (HTTPS)
- [ ] Mobile-friendly design
- [ ] Fast page load times
- [ ] Descriptive URLs

---

## Monitoring

### Google Search Console

After deployment:

1. Verify ownership
2. Submit sitemap
3. Monitor:
   - Index coverage
   - Search queries
   - Click-through rates
   - Mobile usability

### Tools to Use:

- **Google Search Console** - Index status, errors
- **Google Analytics** - Traffic, user behavior
- **Lighthouse** - Performance, SEO score
- **PageSpeed Insights** - Loading speed

---

## Example: Complete Listing Page

```typescript
// app/listings/[id]/page.tsx
import { Metadata } from 'next';
import { notFound } from 'next/navigation';
import { prisma } from '@/lib/prisma';
import { 
    generateListingMetadata, 
    generateListingJsonLd, 
    JsonLd 
} from '@/lib/seo';

// Generate metadata for SEO
export async function generateMetadata({ 
    params 
}: { 
    params: { id: string } 
}): Promise<Metadata> {
    const listing = await prisma.listing.findUnique({
        where: { id: params.id },
        include: {
            category: true,
            brand: true,
            user: {
                select: {
                    name: true,
                    averageRating: true,
                    totalReviews: true,
                },
            },
        },
    });

    if (!listing) {
        return {
            title: 'İlan Bulunamadı',
            description: 'Aradığınız ilan mevcut değil.',
        };
    }

    return generateListingMetadata(listing);
}

export default async function ListingDetailPage({ 
    params 
}: { 
    params: { id: string } 
}) {
    const listing = await prisma.listing.findUnique({
        where: { id: params.id },
        include: {
            category: true,
            brand: true,
            user: true,
        },
    });

    if (!listing) {
        notFound();
    }

    // Generate JSON-LD for rich snippets
    const jsonLd = generateListingJsonLd(listing);

    return (
        <>
            {/* Inject structured data */}
            <JsonLd data={jsonLd} />

            {/* Your page content */}
            <div>
                <h1>{listing.title}</h1>
                <p>{listing.description}</p>
                {/* ... rest of content */}
            </div>
        </>
    );
}
```

---

## Production Deployment

### Before Going Live:

1. **Update environment variables:**
   ```env
   NEXT_PUBLIC_APP_URL=https://ikincises.com
   ```

2. **Update robots.txt sitemap URL**

3. **Submit sitemap to search engines**

4. **Set up Google Search Console**

5. **Test all meta tags:**
   - Use browser inspector
   - Use Facebook Debugger
   - Use Twitter Card Validator

6. **Monitor in Lighthouse:**
   - Target SEO score: 90+
   - Fix any warnings

---

## Troubleshooting

### Meta tags not updating on social media

**Solution:** Clear cache in debuggers:
- Facebook: Use [Sharing Debugger](https://developers.facebook.com/tools/debug/) and click "Scrape Again"
- Twitter: Wait 7 days or contact support

### Sitemap not accessible

**Check:**
1. Route is at `/api/sitemap/route.ts`
2. Database connection is working
3. No errors in server logs

### Structured data errors

**Validate using:**
- [Google Rich Results Test](https://search.google.com/test/rich-results)
- [Schema.org Validator](https://validator.schema.org/)

---

## Next Steps

1. **Apply to all pages** - Add metadata to every page
2. **Monitor performance** - Track SEO score in Lighthouse
3. **Optimize images** - Add proper alt tags
4. **Build backlinks** - Get featured on music forums
5. **Content strategy** - Regular blog posts for SEO

---

## Resources

- [Next.js Metadata Documentation](https://nextjs.org/docs/app/building-your-application/optimizing/metadata)
- [Schema.org Documentation](https://schema.org/)
- [Google Search Central](https://developers.google.com/search)
- [Moz SEO Learning Center](https://moz.com/learn/seo)
